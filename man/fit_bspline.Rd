% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/fit_cyclic_one.R
\name{fit_bspline}
\alias{fit_bspline}
\title{Use bsplies to cyclic trend of gene expression levels}
\usage{
fit_bspline(yy, time)
}
\arguments{
\item{yy}{A vector of gene expression values for one gene. The
expression values are assumed to have been normalized and
transformed to standard normal distribution.}

\item{time}{A vector of angels (cell cycle phase).}
}
\value{
A list with one element, \code{pred.yy}, giving the
estimated cyclic trend.
}
\description{
Use bsplies to cyclic trend of gene expression levels
}
\examples{
library(Biobase)
data(eset_sub)
pdata <- pData(eset_sub)

# cell cycle phase based on FUCCI scores
theta <- pdata$theta
names(theta) <- rownames(pdata)

# normalize expression counts to counts per million
counts_normed <- t((10^6)*t(exprs(eset_sub)[1:5,])/pData(eset_sub)$molecules)
counts_quant <- data_transform_quantile(counts_normed, ncores=2)

# order FUCCI phase and expression
theta_ordered <- theta[order(theta)]
yy_ordered <- counts_quant[1,match(names(theta_ordered), colnames(counts_quant))]

fit <- fit_bspline(yy_ordered, time=theta_ordered)

plot(x=theta_ordered, y=yy_ordered, pch=16, cex=.7, axes=FALSE,
  ylab="quantile-normalized expression values", xlab="FUCCI phase",
  main = "bspline fit")
points(x=theta_ordered, y=fit$pred.yy, col="blue", pch=16, cex=.7)
axis(2)
axis(1,at=c(0,pi/2, pi, 3*pi/2, 2*pi),
  labels=c(0,expression(pi/2), expression(pi), expression(3*pi/2),
  expression(2*pi)))
abline(h=0, lty=1, col="black", lwd=.7)

}
\author{
Joyce Hsiao
}
